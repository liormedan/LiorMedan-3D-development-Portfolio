# תכנית פיתוח – חנות 3D, הדמיית אודיו, וסייר קבצים

מסמך זה מרכז את מפת הדרכים והמשימות להמשך פיתוח שלוש האפליקציות: חנות מוצרים בתלת־ממד, הדמיית גלי קול, וסייר קבצים בתלת־ממד. המשימות מחולקות לפי אפליקציה ותשתיות משותפות, כולל סדרי עדיפויות מוצעים.

## עקרונות כלליים
- פשטות ויציבות מעל הכל; להתחיל מ-MVP ולהרחיב בהדרגה.
- שימור ביצועים: להשתמש ב-Code Splitting, Dynamic Import, ו-Instancing ב-3D.
- חוויית משתמש: נגישות, רספונסיביות, תמיכה בדפדפנים עיקריים.
- בדיקות: יחידה/מרכיב לאזורים קריטיים, וצ׳קים אוטומטיים ב-CI.

---

## אפליקציה 1: חנות מוצרים 3D (`/products`)

### ליבה (P0)
- [x] תשתית נתונים למוצרים (שם, מחיר, תיאור, קישורי מדיה, נתיב/קישור לדגם 3D)
  - נוספו טיפוסים ומערך נתונים: `lib/products.ts`
  - נפתח API: `app/api/products/route.ts` (רשימה או `?slug=`)
  - עמוד `/products` עודכן: רשימת מוצרים + תצוגה וייצוא GLTF
 - [x] טעינת דגמי GLB/GLTF במקום דגם הדמו (קובייה)
   - הוספה ל-`/products`: טעינת GLTF באמצעות `useGLTF` מ-`modelPath` עם נפילה לקובייה בעת חוסר קובץ
   - תמיכה ב-Preload לדגמים ידועים, ו-`Center` להתאמת סצנה למסך
- [x] רשימת מוצרים + עמוד מוצר מפורט (תמונות/תצוגת 3D, מפרט, כפתור הוספה לסל)
  - `/products` מציג גריד מוצרים וקישור לעמודי מוצר
  - עמוד דינמי: `/products/[slug]` + רכיב לקוח להצגת 3D ופרטים
  - חנות: Zustand לסל (`lib/cart.ts`) וכפתור "הוספה לסל"
- [x] סל קניות בצד לקוח (zustand) עם שמירה ב-`localStorage`
  - נוספה התמדה עם `zustand/middleware` (`persist`) ב-`lib/cart.ts` תחת המפתח `cart-v1`
  - שמירת `items` ל-`localStorage` וטעינה אוטומטית בהידרציה בצד לקוח
- [x] ייצוא/הורדה: הורדת הדגם הספציפי של המוצר (GLTF/GLB); תמיכה ב-DRACO בהמשך
  - כפתורי הורדה/ייצוא ב-`/products` וב-`/products/[slug]`:
    - הורדת קובץ מקור אם מוגדר `modelPath`
    - ייצוא כ‑GLTF (JSON) ו‑GLB (Binary) באמצעות `GLTFExporter`
  - DRACO: יתווסף בשלב הבא לצרכי טעינה/דחיסה; נדרש אינטגרציית דקודר בלואדר או Preprocess

### תשלום וקופה (P0-P1)
- [ ] אינטגרציית תשלום (Stripe Checkout/Payment Links) – Sandbox תחילה
- [ ] עמוד Checkout + אישור הזמנה (Success/Cancel)
- [ ] תמחור מטבע/מע״מ/חשבונית (פשטני בשלב ראשון)

### מודלים ותצוגה (P1)
- [ ] טעינת מודלים עם `GLTFLoader` + `Suspense`
- [ ] תאימות טקסטורות/חומרים בסיסית (PBR)
- [ ] פקד מצלמה נוח (OrbitControls) + מגבלות זום/סיבוב
- [ ] יצירת תמונות תצוגה (Thumbnails) – אופציונלי: רנדר סרבר/טרום־עיבוד

### ביצועים (P1)
- [ ] דחיסת דגמים (DRACO/KTX2) + טעינה עצלה (lazy)
- [ ] אופטימיזציית תאורה/צללים, הפחתת polycount היכן שניתן

### תוכן/SEO (P1)
- [ ] מטא־דאטה נקי בעברית ובאנגלית (תיקון `app/layout.tsx` – כרגע יש ג׳יבריש)
- [ ] Open Graph לטובת שיתוף עמודי מוצר

### ניהול תוכן (P2)
- [ ] פאנל ניהול מוצרים בסיסי (CRUD מקומי/קובץ JSON/DB קלילה)
- [ ] העלאת קבצי מודלים דרך ממשק (אל דיסק/אחסון ענן)

---

## אפליקציה 2: הדמיית גלי קול (`/audio-visualizer`)

### שיפור הדמיה (P0-P1)
- [ ] מעבר בין ספקטרום תדרים (Frequency) לגל זמן (Time Domain)
- [ ] מספר עמודות דינמי + צבעוניות/Theme לפי עצימות
- [ ] תוספת שיידרים בסיסיים (bloom/fft trail) – לשמור על ביצועים

### קלט אודיו (P1)
- [ ] גרירת קובץ (Drag & Drop) + בחירה קלאסית
- [ ] שליטה בנגן: Play/Pause, Seek, Volume
- [ ] הצגת שם קובץ/משך/מיקום נוכחי

### ביצועים ונגישות (P1)
- [ ] טוויק ל-`analyser.fftSize` ו-buffer לשמירה על פריימים יציבים
- [ ] קיצורי מקלדת בסיסיים (רווח – Play/Pause)

---

## אפליקציה 3: סייר קבצים 3D (`/file-explorer`)

### הרשאות ודפדפנים (P0)
- [ ] בדיקת תמיכה ב-`showDirectoryPicker`; נפילה לחילופין קבצים ידנית
- [ ] הנחיות UI כשאין הרשאה/תמיכה

### ניווט ותצוגה (P1)
- [ ] תצוגת עץ + פירורי לחם (Breadcrumbs) + “למעלה”
- [ ] אייקון/צבע שונה לקבצים/תיקיות, Tooltip לשמות ארוכים
- [ ] פריסה אדפטיבית (גריד/רשימה) + חיפוש מקומי לפי שם

### אינטראקציות (P1-P2)
- [ ] בחירה מרובה + הדגשת בחירה
- [ ] גרירה לסידור (ויזואלי בלבד, ללא כתיבה לדיסק)
- [ ] תצוגת פרטים: גודל/סוג/תאריך אם הדפדפן מאפשר

### ביצועים (P2)
- [ ] וירטואליזציה של פריטים רבים (טווח תצוגה)
- [ ] InstancedMesh למלבנים רבים ב־3D

---

## תשתיות משותפות

### UI וניווט (P0)
- [ ] Header/Footer/Navigation מינימליים קבועים (Layout משותף)
- [ ] קישור חזרה לדף הבית מכל אפליקציה

### מצב אפליקציה (P0-P1)
- [ ] `zustand` לסל קניות + העדפות משתמש (Theme/Language)
- [ ] שמירה ב-`localStorage` וסנכרון היידרציוני

### ביצועים (P1)
- [ ] Dynamic Import לכל רכיבי 3D כבדים
- [ ] עצירת רנדר כשלא בפוקוס/לא נראה (דגל `frameloop='demand'` היכן שרלוונטי)

### בדיקות ו-CI (P1)
- [ ] בדיקות יחידה ללוגיקה (סל/חישובי מחיר)
- [ ] בדיקות מרכיב בסיסיות (Rendering ללא שגיאות)
- [ ] ESLint/TypeScript Checks ב-CI

### ניטור ושגיאות (P1)
- [ ] גביית שגיאות לקונסולה עם גבול שגיאות React
- [ ] אנליטיקס בסיסי (כגון Vercel/GA4) – צפיות בדפים/אירועים מרכזיים

### אבטחה (P1)
- [ ] ולידציית קלט בצד לקוח/שרת (Zod אם נדרש)
- [ ] כפתורי הורדה: לוודא שאין חשיפת נתיבים רגישים

### PWA (P2)
- [ ] Manifest + Service Worker לטעינה מהירה/Offline בסיסי (בעיקר לתצוגות)

---

## משימות מהירות (Quick Wins)
- [ ] לתקן מטא־דאטה מקולקלת בעברית ב-`app/layout.tsx`
- [ ] לעדכן `README.md` – להסיר התייחסויות לרכיבי פורטפוליו שנמחקו
- [ ] להוסיף לינק חזרה לדף הבית בראש כל אחת משלוש האפליקציות
- [ ] Theme כהה/בהיר גלובלי (Tailwind + class strategy)

---

## שאלות פתוחות
- א. מודלים: האם המודלים יהיו מאוחסנים מקומית, ב-S3, או מנוהלים דרך CMS?
- ב. תשלום: Stripe Checkout מספיק או נדרש תהליך הזמנה מותאם?
- ג. שפות: תמיכה דו־לשונית (עברית/אנגלית) – האם להוסיף i18n עכשיו?
- ד. סטייל: האם לשלב ספריית UI (Radix/HeadlessUI) או להישאר עם Tailwind בלבד?

---

## נספח – חלוקת אבני דרך מוצעת
- שלב 1 (MVP): טעינת דגמים אמיתיים בחנות + הורדה, Audio Visualizer עם שליטה בסיסית, File Explorer עם Directory Picker/קבצים.
- שלב 2: סל + תשלום Stripe, דפי מוצר מלאים, חיפוש בסייר, שיפורי ביצועים 3D.
- שלב 3: פאנל ניהול, אנליטיקס, PWA, וירטואליזציה לסייר, אופטימיזציית מודלים מתקדמת.
